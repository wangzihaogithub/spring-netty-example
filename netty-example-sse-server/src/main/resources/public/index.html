<!DOCTYPE HTML>
<html>
<head>
    <title>My WebSocket</title>
</head>

<body>
<input id="text" type="text"/>
<button onclick="send()">Send</button>
<button onclick="sseSocket.close">Close</button>
<div id="message"></div>
</body>

<script type="text/javascript">
    function sseEventListener(url, eventListeners, query) {
        return import(url).then(module => new module.default({url, eventListeners, query}))
    }

    var sseSocket = sseEventListener('/my-sse',
        {
            event1: (event) => {
                setMessageInnerHTML(event.data)
            }
        },
        {
            'access-token': '123'
        });


    setTimeout(() => {
        sseSocket.close()
    }, 30000)

    //将消息显示在网页上
    function setMessageInnerHTML(innerHTML) {
        document.getElementById('message').innerHTML += innerHTML + '<br/>';
    }

    function send() {
        var message = document.getElementById('text').value;
        const path = 'send1'
        const body = {}
        const query = {message}
        const headers = {}
        //发送消息
        sseSocket.send(path, body, query, headers)

    }
</script>
</html>